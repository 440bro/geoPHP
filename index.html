<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/railscasts.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>GeoPHP - The world&#39;s most popular geospatial library for PHP</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>GeoPHP</h1>
        <h2>The world&#39;s most popular geospatial library for PHP</h2>
        <a href="https://github.com/phayes/geoPHP" class="button"><small>View project on</small> GitHub</a>
      </div>
      <div class="header-links">
        <a href="/">Home</a>
        <a href="api.html">API Refernce</a>
        <a href="geos.html">GEOS Integration</a>
      </div>
      <div class="clearfix"></div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <p>GeoPHP is a open-source native PHP library for doing geometry operations. It is written entirely in PHP and 
can therefore run on shared hosts. It can read and write a wide variety of formats: WKT (including EWKT), WKB (including EWKB), GeoJSON, 
KML, GPX, GeoRSS. It works with all Simple-Feature geometries (Point, LineString, Polygon, GeometryCollection etc.)
and can be used to get centroids, bounding-boxes, area, and a wide variety of other useful information. </p>

<p>geoPHP also helpfully wraps the <a href="geos.html">GEOS php extension</a> so that applications can get a transparent performance 
increase when GEOS is installed on the server. When GEOS is installed, geoPHP also becomes
fully compliant with the OpenGISÂ® Implementation Standard for Geographic information. With GEOS you get the 
full-set of openGIS functions in PHP like Union, IsWithin, Touches etc. This means that applications
get a useful "core-set" of geometry operations that work in all environments, and an "extended-set"of operations 
for environments that have GEOS installed. </p>

<h2><a id="example-usage" class="anchor" href="#example-usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example usage</h2>

<pre><code class="php">// Polygon WKT example
$polygon = geoPHP::load('POLYGON((1 1,5 1,5 5,1 5,1 1),(2 2,2 3,3 3,3 2,2 2))','wkt');
$area = $polygon->getArea();
$centroid = $polygon->getCentroid();
$centX = $centroid->getX();
$centY = $centroid->getY();

print("This polygon has an area of ".$area." and a centroid with X=".$centX." and Y=".$centY);
</pre></code>

<pre><code class="php">// MultiPoint json example
$json = '{
   "type": "MultiPoint",
   "coordinates": [
       [100.0, 0.0], [101.0, 1.0]
   ]
}';

$multipoint = geoPHP::load($json, 'json');
$multipoint_points = $multipoint->getComponents();
$first_wkt = $multipoint_points[0]->out('wkt');

print("This multipoint has ".$multipoint->numGeometries()." points. The first point has a wkt representation of ".$first_wkt);
</code></pre>

<h2>
<a id="more-examples" class="anchor" href="#more-examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>More Examples</h2>

<p>The Well Known Text (WKT) and Well Known Binary (WKB) support is ideal for integrating with MySQL's or PostGIS's spatial capability. 
Once you have SELECTed your data with <code>'AsText('geo_field')'</code> or <code>'AsBinary('geo_field')'</code>, you can put it straight into 
geoPHP</p>

<pre><code class='php'>$geom = geoPHP::load($dbRow);</code></pre>

<p>You can collect multiple geometries into one:</p>

<pre><code class='php'>$geom = geoPHP::load("GEOMETRYCOLLECTION(".$dbString1.",".$dbString2.")");</code></pre>

<p>Calling get components returns the sub-geometries within a geometry as an array.</p>

<pre><code class='php'>$geom2 = geoPHP::load("GEOMETRYCOLLECTION(LINESTRING(1 1,5 1,5 5,1 5,1 1),LINESTRING(2 2,2 3,3 3,3 2,2 2))");
$geomComponents = $geom2-&gt;getComponents();    //an array of the two linestring geometries
$linestring1 = $geomComponents[0]-&gt;getComponents(); //an array of the first linestring's point geometries
$linestring2 = $geomComponents[1]-&gt;getComponents();
echo $linestring1[0]-&gt;x() . ", " . $linestring1[0]-&gt;y();    //outputs '1, 1'
</code></pre>

<p>An alternative is to use the <code>asArray()</code> method. Using the above geometry collection of two linestrings, </p>

<pre><code class='php'>$geometryArray = $geom2-&gt;asArray();
echo $geometryArray[0][0][0] . ", " . $geometryArray[0][0][1];    //outputs '1, 1'
</code></pre>

<p>Clearly, more complex analysis is possible.</p>

<pre><code>echo $geom2-&gt;envelope()-&gt;area();
</code></pre>

<h2>
<a id="working-with-postgis" class="anchor" href="#working-with-postgis" aria-hidden="true"><span class="octicon octicon-link"></span></a>Working with PostGIS</h2>

<p>geoPHP, through it's EWKB adapter, has good integration with postGIS. Here's an example of reading and writing postGIS geometries</p>

<pre><code class='php'>
include_once('geoPHP.inc');

$host =     'localhost';
$database = 'phayes';
$table =    'test';
$column =   'geom';
$user =     'phayes';
$pass =     'supersecret';

$connection = pg_connect("host=$host dbname=$database user=$user password=$pass");

// Working with PostGIS and Extended-WKB
// -------------------------------------

// Using asBinary and GeomFromWKB in PostGIS
$result = pg_fetch_all(pg_query($connection, "SELECT asBinary($column) as geom FROM $table"));
foreach ($result as $item) {
  $wkb = pg_unescape_bytea($item['geom']); // Make sure to unescape the hex blob
  $geom = geoPHP::load($wkb, 'ewkb'); // We now a full geoPHP Geometry object

  // Let's insert it back into the database
  $insert_string = pg_escape_bytea($geom->out('ewkb'));
  pg_query($connection, "INSERT INTO $table ($column) values (GeomFromWKB('$insert_string'))");
}

// Using a direct SELECT and INSERTs in PostGIS without using wrapping functions
$result = pg_fetch_all(pg_query($connection, "SELECT $column as geom FROM $table"));
foreach ($result as $item) {
  $wkb = pack('H*',$item['geom']);   // Unpacking the hex blob
  $geom = geoPHP::load($wkb, 'ewkb'); // We now have a geoPHP Geometry

  // To insert directly into postGIS we need to unpack the WKB
  $unpacked = unpack('H*', $geom->out('ewkb'));
  $insert_string = $unpacked[1];
  pg_query($connection, "INSERT INTO $table ($column) values ('$insert_string')");
}
</code></pre>

<h2>
<a id="credit" class="anchor" href="#credit" aria-hidden="true"><span class="octicon octicon-link"></span></a>Credit</h2>

<p>Maintainer: <a href="https://github.com/phayes">Patrick Hayes</a></p>

<p>Additional Contributors:</p>

<ul>
<li>GeoMemes Research (<a href="http://www.geomemes.com">http://www.geomemes.com</a>)</li>
<li>HighWire Press (<a href="http://www.highwire.org">http://www.highwire.org</a>) and GeoScienceWorld (<a href="http://www.geoscienceworld.org">http://www.geoscienceworld.org</a>)</li>
<li>Arnaud Renevier (gisconverter.php) <a href="https://github.com/arenevier/gisconverter.php">https://github.com/arenevier/gisconverter.php</a>
</li>
<li>Dave Tarc <a href="https://github.com/dtarc">https://github.com/dtarc</a>
</li>
<li>Elliott Hunston (documentation) <a href="https://github.com/ejh">https://github.com/ejh</a>
</li>
</ul>

<p>This library is open-source and dual-licensed under both the Modified BSD License and GPLv2. Either license may be used at your option.           </p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/phayes/geoPHP/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/phayes/geoPHP/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>
          <div style='text-align:center; margin-bottom:20px'>
            <a href="https://travis-ci.org/phayes/geoPHP"><img src="https://travis-ci.org/phayes/geoPHP.svg?branch=master"></img></a>
          </div>
          <div>
            <p>Maintained by Patrick Hayes<br/>
            <a href="https://linkedin.com/in/patrickdhayes/">linkedin.com/in/patrickdhayes</a><br/>
            <a href="https://github.com/phayes">github.com/phayes</a></p>
          </div>
        </aside>
      </div>
    </div>

  
  </body>
</html>
